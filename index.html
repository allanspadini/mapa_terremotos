<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt-br" xml:lang="pt-br">
<head>
    <title>Terremotos no mundo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    
    <link rel="stylesheet" type="text/css" href="style.css"> 
    <link rel="stylesheet" href="css/bootstrap.css">   
    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>
</head>
<body>

    <header>
        <h1> <a target="_blank" href="https://www.amazon.com.br/Sobre-Terra-Hist%25C3%25B3ria-Terremoto-Lisboa/dp/857475255X/ref=sr_1_4?__mk_pt_BR=%25C3%2585M%25C3%2585%25C5%25BD%25C3%2595%25C3%2591&amp;crid=1C2BJWUJZ4BU9&amp;keywords=terremoto&amp;qid=1688473977&amp;rnid=18726358011&amp;s=books&amp;sprefix=terremoto%252Caps%252C232&amp;sr=1-4&_encoding=UTF8&tag=geofisico-20&linkCode=ur2&linkId=f90205695f8a981bb006e6aad0098b04&camp=1789&creative=9325">Terremotos</a> com magnitude maior ou igual a 4.5 nas últimas 24 horas</h1>
    </header>
    
    <section>

        <div class="block" id="block1">Total de eventos</div>
        <div class="block" id="block2">Maior magnitude</div>
        <div class="block" id="block3">Local do maior evento</div>
    </section>

    <section>
        <div id="mapa"></div>
        <div class="magnitude" id="magnitude">
            <iframe sandbox="allow-popups allow-scripts allow-modals allow-forms allow-same-origin" style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="//ws-na.amazon-adsystem.com/widgets/q?ServiceVersion=20070822&OneJS=1&Operation=GetAdHtml&MarketPlace=BR&source=ss&ref=as_ss_li_til&ad_type=product_link&tracking_id=geofisico-20&language=pt_BR&marketplace=amazon&region=BR&placement=857475255X&asins=857475255X&linkId=e6af9540a908081bcbd5ef21ce6ec225&show_border=true&link_opens_in_new_window=true"></iframe>
        
        </div>

    </section>
    
    <footer>
        Fonte de dados: USGS: <a href='https://www.usgs.gov/programs/earthquake-hazards'>https://www.usgs.gov/programs/earthquake-hazards</a>
    </footer>
    
    <py-config>
        packages=["folium","pandas","matplotlib"]
    </py-config>
    
    

    <py-script>
        import folium
        import pandas as pd
        from pyodide.http import open_url
        import matplotlib.pyplot as plt
        import matplotlib.patheffects as path_effects
        
        # Define o URL base da API
        url = 'https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/4.5_day.csv'
        
        # Define os parâmetros da consulta
        df = pd.read_csv(open_url(url))
        
        #MAPA
        m = folium.Map(location=[-15.77,-47.94],zoom_start=2,tiles='Stamen Terrain')
        grupo_terremotos = folium.map.FeatureGroup()
        for lat, lon,magi in zip(df['latitude'],df['longitude'],df['mag']):
                grupo_terremotos.add_child(
                folium.CircleMarker([lat,lon],radius=magi,fill_color='red', 
                fill_opacity=0.5, color='red',popup=folium.Popup(f'Latitude:{lat}\n Longitude:{lon} \n Magnitude:{magi}'))
                )
        m.add_child(grupo_terremotos)
        display(m,target="mapa",append=False)

        #BLOCK1
        fig = plt.figure(figsize=(2, 2))
        text=fig.text(0.5, 0.5,str(len(df)), horizontalalignment='center',
        verticalalignment='center',fontsize=24)
        text.set_path_effects([path_effects.Normal()])        
        display(fig,target="block1")

        #BLOCK2
        fig = plt.figure(figsize=(2, 2))
        text=fig.text(0.5, 0.5,str(df['mag'].max()), horizontalalignment='center',
        verticalalignment='center',fontsize=24)
        text.set_path_effects([path_effects.Normal()])        
        display(fig,target="block2")

        #BLOCK3
        fig = plt.figure(figsize=(2, 2))
        indice_max = df['mag'].idxmax()
        local_max = df.loc[indice_max, 'place']

        text=fig.text(0.5, 0.5,str(local_max), horizontalalignment='center',
        verticalalignment='center',fontsize=12,wrap=True)
        text.set_path_effects([path_effects.Normal()])        
        display(fig,target="block3")

    </py-script>

    

    <script src="js/jquery.js"></script>
    <script src="js/bootstrap.js.js"></script>
   
</body>
</html>
